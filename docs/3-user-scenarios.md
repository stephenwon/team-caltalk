# Team CalTalk 사용자 시나리오

**문서 버전**: 3.1
**최종 업데이트**: 2025-10-05
**작성자**: Product Team
**주요 변경**:
- v3.0: 역할 기반 권한 시스템 반영 (팀장만 일정 생성, 팀원은 변경 요청)
- v3.1: 실제 라우팅 경로 반영 (/register, /teams/join, /calendar 등)

## 📊 구현 현황 (2025-10-05 기준)

### ✅ 완전 구현된 시나리오
- ✅ **시나리오 1**: 신규 팀 생성 및 팀원 초대
- ✅ **시나리오 2**: 역할 기반 일정 관리 (팀장의 일정 생성, 팀원의 변경 요청)
- ✅ **시나리오 3**: 일정 충돌 발생 및 팀장의 해결
- ✅ **시나리오 4**: 예외 상황 처리 (권한 검증, 팀장 부재 대응)

### 🎯 실제 구현된 주요 기능
- ✅ JWT 기반 회원가입/로그인
- ✅ 팀 생성 및 초대 코드 시스템
- ✅ **역할 기반 권한 시스템**:
  - 팀장: 팀 일정 생성, 수정, 삭제 권한
  - 팀원: 팀 일정 조회만 가능, 변경은 요청을 통해서만
- ✅ 팀 일정 CRUD 및 캘린더 뷰 (팀장 전용)
- ✅ 일정 충돌 감지 (PostgreSQL Range + GIST)
- ✅ 날짜별 실시간 채팅 (30초 폴링)
- ✅ **일정 변경 요청/승인/거절 워크플로우** (팀원 → 팀장)
- ✅ 대시보드 최근 활동 내역

## 개요

본 문서는 Team CalTalk의 핵심 기능들이 실제로 구현되어 어떻게 작동하는지를 보여주는 시나리오들을 제시합니다. 모든 시나리오는 실제 구현된 기능을 기반으로 작성되었으며, **역할 기반 권한 시스템**을 중심으로 구성되었습니다.

### 핵심 권한 규칙
- **팀장(leader)**: 팀 일정 생성, 수정, 삭제 전체 권한 보유
- **팀원(member)**: 팀 일정 조회만 가능, 변경이 필요한 경우 채팅 또는 변경 요청 기능을 통해 팀장에게 요청

### 주요 라우팅 경로
- 회원가입: `/register`
- 로그인: `/login`
- 대시보드: `/dashboard`
- 팀 목록: `/teams`
- 팀 생성: `/teams/create`
- 팀 참여: `/teams/join`
- 팀 상세: `/teams/{팀ID}`
- 캘린더: `/calendar`

## 시나리오 1: 신규 팀 생성 및 팀원 초대

### 배경

김개발은 새로운 프로젝트를 위해 Team CalTalk에서 팀을 생성하고 팀원들을 초대해야 합니다.

### 참여자

- **김개발**: 10명 개발팀의 팀장, 32세
- **이코더**: 시니어 개발자, 28세 (초대받을 팀원)

### 시나리오 진행

#### 1단계: 김개발의 회원가입 및 팀 생성

**사용자 행동:**

1. 김개발이 Team CalTalk 웹사이트(http://localhost:5173)에 접속
2. "회원가입" 링크 클릭 → `/register` 페이지로 이동
3. 이메일(kim.dev@company.com), 비밀번호(DevTeam2024!), 이름(김개발) 입력
4. "가입하기" 버튼 클릭

**시스템 반응:**

1. 이메일 형식 및 비밀번호 강도 검증 완료
2. 중복 이메일 확인 후 계정 생성 성공
3. JWT 토큰 발급 및 자동 로그인 처리
4. `/dashboard` 페이지로 리다이렉트

**사용자 행동:**

5. 대시보드에서 "새 팀 만들기" 버튼 클릭 → `/teams/create` 페이지로 이동
6. 팀 이름 "백엔드 개발팀", 팀 설명 "신규 API 서버 개발 프로젝트" 입력
7. "팀 생성" 버튼 클릭

**시스템 반응:**

5. 팀 생성 폼 표시
6. 팀 데이터 저장 및 고유 초대 코드 "BK2024DEV" 자동 생성
7. 김개발에게 팀장(leader) 권한 자동 부여
8. `/teams/{팀ID}` 페이지로 이동, 초대 코드 안내 팝업 표시

#### 2단계: 팀원 초대 및 참여

**사용자 행동:**

1. 김개발이 초대 코드 "BK2024DEV"를 이코더에게 메신저로 전송
2. 이코더가 Team CalTalk 접속 후 `/register` 페이지에서 회원가입 완료
3. 로그인 후 대시보드로 이동
4. 네비게이션에서 "팀" 메뉴 클릭 → `/teams` 페이지로 이동
5. "팀 참여" 버튼 클릭 → `/teams/join` 페이지로 이동
6. 초대 코드 "BK2024DEV" 입력
7. "참여하기" 버튼 클릭

**시스템 반응:**

1. 초대 코드 유효성 검증 완료
2. 이코더를 "백엔드 개발팀"에 팀원(member) 권한으로 추가
3. `team_members` 테이블에 팀원 정보 저장
4. `/teams/{팀ID}` 팀 대시보드로 리다이렉트 및 접근 권한 부여
5. 김개발에게 "이코더님이 팀에 참여했습니다" 알림 전송

**중요:**
- 팀원은 **반드시 초대 코드를 통해 팀에 참여**해야 합니다
- 초대 코드 입력 없이는 팀 일정 조회 및 채팅방 접근이 불가능합니다
- 로그인만으로는 자동으로 팀에 참여되지 않습니다

#### 3단계: 초기 설정 완료

**사용자 행동:**

1. 김개발이 팀 대시보드에서 팀원 목록 확인
2. 이코더가 팀 캘린더와 채팅방 접근 확인

**시스템 반응:**

1. 팀원 목록에 김개발(팀장), 이코더(팀원) 표시
2. 빈 팀 캘린더와 환영 메시지가 있는 채팅방 표시
3. 양쪽 모두 실시간 채팅 연결 활성화

**결과:**
팀 생성 및 초대 과정이 3분 내에 완료되어 즉시 협업 가능한 상태가 됨

---

## 시나리오 2: 일상적인 일정 관리

### 배경

팀이 구성된 후, 김개발과 이코더가 일주일간 일정을 관리하는 과정입니다.

### 시나리오 진행

#### 1단계: 팀 일정 생성 (월요일 오전)

**사용자 행동 - 김개발 (팀장):**

1. 네비게이션에서 "캘린더" 메뉴 클릭 → `/calendar` 페이지로 이동
2. 캘린더 뷰에서 화요일 14:00 클릭하여 일정 생성 폼 열기
3. 제목 "주간 스프린트 계획", 시간 "14:00-16:00", 설명 "이번 주 개발 계획 수립" 입력
4. 참가자 "전체 팀원" 선택
5. "팀 일정 저장" 버튼 클릭

**시스템 반응:**

1. 팀장 권한 확인 완료
2. 날짜/시간 유효성 검증 완료
3. 팀 일정 생성 및 캘린더에 주황색으로 표시
4. 모든 팀원에게 "새 팀 일정이 등록되었습니다" 알림 전송
5. 저장 완료 알림 표시

#### 2단계: 추가 팀 일정 생성 및 충돌 감지 (월요일 오후)

**사용자 행동 - 김개발:**

1. 수요일 15:00 슬롯에서 "팀 일정 추가" 선택
2. 제목 "코드 리뷰 미팅", 시간 "15:00-17:00", 참가자 "전체 팀원" 선택
3. "팀 일정 저장" 버튼 클릭

**시스템 반응:**

1. 팀원들의 기존 일정과 충돌 검사 실행
2. 충돌 없음 확인 후 팀 일정 생성
3. 팀 캘린더에 주황색으로 팀 일정 표시
4. 이코더에게 "새 팀 일정이 등록되었습니다" 실시간 알림

**사용자 행동 - 김개발 (계속):** 5. 화요일 15:00에 "긴급 버그 픽스 미팅" 추가 시도 6. 참가자에 이코더 포함하여 일정 생성

**시스템 반응:** 5. 이코더의 화요일 14:00-16:00 개인 일정과 충돌 감지 6. 빨간색 경고 팝업 표시: "이코더님의 '고객사 기술 미팅'과 1시간 겹칩니다" 7. "그래도 생성", "시간 변경", "취소" 옵션 제공

#### 3단계: 팀원의 일정 변경 요청 (화요일)

**배경 상황:**
이코더가 개인 사정으로 화요일 14:00-16:00 "주간 스프린트 계획" 일정을 수요일로 변경하고 싶음

**사용자 행동 - 이코더 (팀원):**

1. 캘린더에서 화요일 14:00 "주간 스프린트 계획" 클릭
2. "일정 수정" 버튼 클릭 시도

**시스템 반응:**

1. 팀원 권한 확인 - 팀 일정 수정 권한 없음
2. "팀장만 팀 일정을 수정할 수 있습니다" 메시지 표시
3. "일정 변경 요청" 버튼 제공

**사용자 행동 - 이코더:**

3. "일정 변경 요청" 버튼 클릭
4. 변경 요청 폼에서:
   - 희망 날짜: 수요일 14:00-16:00
   - 사유: "화요일 개인 병원 예약이 있어 수요일로 변경 요청합니다"
5. "요청 보내기" 버튼 클릭

**시스템 반응:**

4. 변경 요청 생성 및 저장
5. 팀 채팅방에 자동 메시지 전송: "이코더님이 '주간 스프린트 계획' 일정 변경을 요청했습니다 (화→수)"
6. 김개발에게 알림 전송: "새로운 일정 변경 요청이 있습니다"
7. 요청 메시지를 화요일, 수요일 날짜에 모두 연결

#### 4단계: 팀장의 변경 요청 처리

**사용자 행동 - 김개발 (팀장):**

1. 알림을 보고 채팅방 확인
2. 변경 요청 메시지 확인 후 "승인" 또는 "거절" 버튼 선택
3. "승인" 버튼 클릭

**시스템 반응:**

1. 수요일 14:00-16:00 시간대 충돌 검사 실행
2. 충돌 없음 확인 후 일정 변경 처리
3. 기존 화요일 일정 삭제, 수요일에 새 일정 생성
4. 채팅방에 "김개발님이 일정 변경 요청을 승인했습니다" 자동 메시지
5. 모든 참가자에게 "일정이 수요일로 변경되었습니다" 알림 전송

**대안 시나리오 - 거절하는 경우:**

**사용자 행동 - 김개발:**
- "거절" 버튼 클릭
- 거절 사유: "수요일에 이미 중요한 외부 미팅이 잡혀있어서 화요일 유지가 필요합니다"

**시스템 반응:**
- 채팅방에 "김개발님이 일정 변경 요청을 거절했습니다" 메시지와 사유 표시
- 이코더에게 거절 알림 전송
- 원래 일정 유지

**결과:**
팀원은 채팅을 통해 일정 변경을 요청하고, 팀장이 승인/거절하는 명확한 권한 체계 확립

---

## 시나리오 3: 일정 충돌 발생 및 해결

### 배경

목요일에 예상치 못한 긴급 상황이 발생하여 기존 일정과 충돌이 발생하는 상황입니다.

### 시나리오 진행

#### 1단계: 긴급 상황 발생

**배경 상황:**

- 기존 계획: 목요일 14:00-16:00 "스프린트 계획 미팅" (김개발, 이코더 참석)
- 돌발 상황: 운영 서버에 치명적 버그 발견으로 긴급 수정 필요

#### 2단계: 긴급 일정 추가 시도

**사용자 행동 - 김개발:**

1. 목요일 14:30-17:00 "긴급 버그 수정 작업" 팀 일정 생성 시도
2. 전체 개발팀 참가자로 지정

**시스템 반응:**

1. 기존 "스프린트 계획 미팅"과 90분 겹침 감지
2. 상세 충돌 정보 표시:
   - 충돌 일정: "스프린트 계획 미팅" (14:00-16:00)
   - 겹치는 시간: 14:30-16:00 (90분)
   - 영향받는 팀원: 김개발, 이코더
3. 해결 방안 제안:
   - "기존 일정 이동"
   - "새 일정 시간 조정"
   - "기존 일정 취소"

#### 3단계: 채팅을 통한 긴급 협의

**사용자 행동 - 김개발:**

1. 채팅방에 긴급 메시지 전송: "🚨 운영 서버 긴급 상황! 스프린트 미팅을 금요일로 미룰 수 있을까요?"
2. 상황 설명: "고객 주문 처리가 멈춘 상태라서 즉시 수정이 필요합니다"

**시스템 반응:**

1. 긴급 메시지로 분류하여 강조 표시 (빨간색 배경)
2. 모든 팀원에게 푸시 알림 즉시 전송
3. 메시지를 목요일과 금요일 모두에 연결

**사용자 행동 - 이코더:** 3. 즉시 응답: "네, 이해했습니다. 금요일 같은 시간 괜찮아요" 4. "필요하면 스프린트 준비는 제가 미리 해두겠습니다"

#### 4단계: 팀장의 일정 재조정 실행

**사용자 행동 - 김개발 (팀장):**

1. 기존 "스프린트 계획 미팅" 클릭하여 수정 모드 진입
2. 날짜를 금요일 14:00-16:00으로 변경
3. "일정 수정" 버튼 클릭

**시스템 반응:**

1. 팀장 권한 확인 완료
2. 금요일 해당 시간대 충돌 검사 - 충돌 없음 확인
3. 기존 일정 삭제 후 새 날짜에 재생성
4. 변경 알림을 모든 참가자에게 전송: "스프린트 계획 미팅이 금요일로 이동되었습니다"
5. 채팅방에 "김개발님이 '스프린트 계획 미팅'을 금요일로 변경했습니다" 자동 메시지

**사용자 행동 - 김개발 (계속):**

4. 이제 목요일 14:30-17:00 "긴급 버그 수정 작업" 재생성
5. 우선순위 "높음"으로 설정
6. "팀 일정 저장" 버튼 클릭

**시스템 반응:**

6. 팀장 권한 확인 완료
7. 충돌 없음 확인 후 긴급 일정 생성 완료
8. 빨간색으로 높은 우선순위 일정 표시
9. 팀원들에게 긴급 일정 알림 전송

#### 5단계: 팀원의 대응 및 확인

**사용자 행동 - 이코더 (팀원):**

1. 채팅방에 "확인했습니다. 14:30까지 현재 작업 마무리하겠습니다" 메시지 전송
2. 변경된 일정 확인

**시스템 반응:**

1. 메시지 즉시 전달
2. 이코더의 캘린더에 변경된 팀 일정 자동 반영
3. 금요일 이동된 스프린트 미팅도 표시

**참고:**
- 팀원은 팀 일정을 직접 수정할 수 없음
- 변경이 필요한 경우 채팅으로 요청하거나 "일정 변경 요청" 기능 사용

**결과:**
팀장만 팀 일정을 수정할 수 있는 권한 체계로 긴급 상황에서도 명확한 의사결정 가능, 5분 내 일정 재조정 완료

---

## 시나리오 4: 예외 상황 처리

### 배경

다양한 예외 상황들이 연쇄적으로 발생하여 시스템과 사용자가 이를 처리하는 과정입니다.

### 시나리오 진행

#### 상황 1: 네트워크 연결 문제

**발생 상황:**
김개발이 중요한 팀 일정을 수정하는 중에 인터넷 연결이 불안정해짐

**사용자 행동:**

1. 김개발이 "주간 회고 미팅" 시간을 변경하려고 수정 폼에서 시간 조정
2. "저장" 버튼 클릭

**시스템 반응:**

1. 네트워크 요청 타임아웃 발생
2. "연결 문제가 발생했습니다. 재시도 중..." 메시지 표시
3. 사용자 입력 데이터를 로컬 스토리지에 임시 저장
4. 3초 간격으로 자동 재시도 실행

**사용자 행동:** 3. 30초 후 네트워크 연결 복구

**시스템 반응:** 5. 네트워크 복구 감지 후 임시 저장된 데이터로 자동 재전송 6. 일정 수정 성공 후 "일정이 저장되었습니다" 확인 메시지 7. 로컬 임시 데이터 삭제

#### 상황 2: 동시 수정 충돌

**발생 상황:**
김개발과 이코더가 같은 시간에 같은 일정에 대해 서로 다른 변경을 시도

**사용자 행동:**

1. 김개발: "API 설계 리뷰" 일정 시간을 10:00→11:00으로 변경 시도
2. 이코더: 동시에 같은 일정의 장소를 "회의실A→회의실B"로 변경 시도

**시스템 반응:**

1. 김개발의 요청이 먼저 처리되어 시간 변경 성공
2. 이코더의 요청 처리 시 데이터 버전 충돌 감지
3. 이코더에게 충돌 알림 표시: "다른 사용자가 이 일정을 수정했습니다"
4. 최신 일정 정보와 이코더의 변경사항을 비교하여 표시

**사용자 행동:** 3. 이코더가 충돌 해결 방안 선택: "최신 버전에 내 변경사항 적용"

**시스템 반응:** 5. 김개발의 시간 변경 + 이코더의 장소 변경을 합쳐서 최종 일정 생성 6. 양쪽 모두에게 "일정이 통합되어 저장되었습니다" 알림 7. 변경 이력에 두 사용자의 수정 내역 모두 기록

#### 상황 3: 권한 관련 예외

**발생 상황:**
팀원인 이코더가 팀 일정을 수정하려고 시도하는 상황

**사용자 행동:**

1. 이코더 (팀원)가 팀 일정 "주간 회고 미팅"을 수정하려고 클릭
2. "일정 수정" 버튼 클릭

**시스템 반응:**

1. 팀원 권한 확인 - 팀 일정 수정 권한 없음 확인
2. "팀장만 팀 일정을 수정할 수 있습니다" 메시지 표시
3. 다음 옵션 제공:
   - "일정 변경 요청하기" 버튼
   - "채팅으로 문의하기" 버튼
4. 수정 시도 로그 기록 (보안 감사용)

**사용자 행동:**

3. 이코더가 "일정 변경 요청하기" 선택
4. 변경 요청 폼에 희망 시간과 사유 입력
5. 요청 전송

**시스템 반응:**

5. 변경 요청 생성 및 채팅방에 자동 메시지 전송
6. 팀장에게 알림 전송
7. "요청이 전송되었습니다. 팀장의 승인을 기다려주세요" 확인 메시지

**결과:**
명확한 권한 체계로 팀원의 무단 수정을 방지하고, 적절한 요청 절차 안내

#### 상황 4: 메시지 전송 실패 및 복구

**발생 상황:**
서버 부하로 인해 채팅 메시지 전송이 실패하는 상황

**사용자 행동:**

1. 김개발이 중요한 공지사항을 채팅에 입력 후 전송
2. "내일 배포 일정이 하루 앞당겨졌습니다. 모든 테스트를 오늘 완료해주세요"

**시스템 반응:**

1. 서버 과부하로 메시지 전송 실패
2. 김개발 화면에 "전송 실패" 상태 표시 (빨간 느낌표)
3. 메시지를 전송 대기열에 보관
4. "메시지 전송에 실패했습니다. 재전송하시겠습니까?" 옵션 제공

**사용자 행동:** 3. 김개발이 "재전송" 버튼 클릭

**시스템 반응:** 5. 서버 상태 확인 후 메시지 재전송 성공 6. 이코더에게 메시지 정상 전달 7. 김개발 화면에서 "전송 완료" 체크 표시로 변경 8. 메시지 전송 시간은 원래 시도한 시각으로 기록

#### 상황 5: 팀장 부재 시 권한 관리

**발생 상황:**
김개발 (팀장)이 휴가로 3일간 부재 중, 긴급 팀 일정 변경이 필요한 상황

**사용자 행동:**

1. 이코더 (팀원)가 팀 일정 수정을 시도하지만 권한 없음 메시지 확인
2. 채팅에서 "팀장님이 부재중인데 긴급 일정 변경이 필요합니다" 메시지 입력

**시스템 반응:**

1. 팀원 권한 확인 - 수정 권한 없음
2. "팀장만 팀 일정을 수정할 수 있습니다" 메시지 표시
3. 다음 대안 제공:
   - "일정 변경 요청 남기기" (팀장 복귀 시 확인)
   - "다른 팀원에게 문의하기"
   - "긴급 요청으로 표시하기"

**사용자 행동:**

3. 이코더가 "긴급 요청으로 표시하기" 선택
4. 사유: "고객 데모 일정 변경으로 개발 일정 조정 시급" 입력
5. 긴급 요청 전송

**시스템 반응:**

4. 긴급 변경 요청 생성 및 저장
5. 채팅방에 빨간색 강조로 긴급 요청 메시지 표시
6. 김개발의 이메일로 긴급 알림 발송
7. 팀 내 다른 팀원들에게도 알림 (협의 가능하도록)
8. 모든 요청 이력을 감사 로그에 기록

**팀장 복귀 후 처리:**

1. 김개발 로그인 시 긴급 요청 목록 우선 표시
2. 각 요청에 대해 "승인", "거절", "직접 수정" 옵션 제공
3. 처리 결과를 요청자에게 자동 알림

**결과:**
팀장 부재 시에도 명확한 권한 체계 유지하며, 긴급 상황에 대한 적절한 요청 및 알림 프로세스로 대응

---

## 시나리오 요약 및 시사점

### 주요 성과

1. **신속한 팀 구성**: 3분 내 팀 생성부터 첫 번째 협업까지 완료
2. **효과적인 충돌 해결**: 실시간 채팅을 통해 2-5분 내 일정 조율 완료
3. **투명한 의사결정**: 모든 변경 과정이 채팅 이력으로 보존되어 추후 참조 가능
4. **안정적인 예외 처리**: 다양한 기술적/비즈니스 예외 상황에서도 업무 연속성 보장

### 사용자 경험 포인트

- **직관적 워크플로우**: 복잡한 학습 과정 없이 즉시 사용 가능
- **실시간 피드백**: 모든 액션에 대한 즉각적인 시각적/텍스트 피드백
- **상황 인식**: 시스템이 사용자의 의도와 상황을 이해하고 적절한 안내 제공
- **협업 중심**: 개인 도구가 아닌 팀 협업을 위한 설계

### 기술 구현 검증점

- 실시간 메시지 전달 (1초 이내) 요구사항 충족
- 일정 충돌 감지 알고리즘의 정확성 및 성능
- 예외 상황에서의 데이터 일관성 보장
- 사용자 권한 관리의 유연성과 보안성

이러한 시나리오들은 Team CalTalk이 실제 업무 환경에서 어떻게 팀의 생산성을 향상시키고 원활한 소통을 지원하는지를 구체적으로 보여줍니다.
